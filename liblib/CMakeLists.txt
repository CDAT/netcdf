SET(CMAKE_INCLUDE_CURRENT_DIR ON)

INCLUDE_DIRECTORIES(".")

SET(liblib_LIBS dispatch netcdf3)

IF(USE_HDF5 OR USE_NETCDF4) 
	SET(liblib_LIBS ${liblib_LIBS} netcdf4)
ENDIF()

IF(BUILD_DAP)
	SET(liblib_LIBS ${liblib_LIBS} oc)
ENDIF()

FOREACH(LIBS ${liblib_LIBS})
	SET(LARGS ${LARGS} $<TARGET_OBJECTS:${LIBS}>)
ENDFOREACH()

ADD_LIBRARY(netcdf stub.c ${LARGS})

IF(BUILD_DAP)
	TARGET_LINK_LIBRARIES(netcdf ${CURL_LIBRARIES})
ENDIF(BUILD_DAP)

IF(USE_HDF5 OR USE_NETCDF4)
	TARGET_LINK_LIBRARIES(netcdf ${HDF5_LIBRARIES} ${HDF5_HL_LIBRARY} )
ENDIF()
#TARGET_LINK_LIBRARIES(netcdf ${LARGS})
#ADD_LIBRARY(netcdf stub.c $<TARGET_OBJECTS:dispatch> $<TARGET_OBJECTS:netcdf3>)

